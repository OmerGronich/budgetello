<div
  class="board"
  cdkDropList
  cdkDropListOrientation="horizontal"
  cdkDropListGroup
  (cdkDropListDropped)="dropList($event)"
>
  <div
    class="list"
    cdkDrag
    *ngFor="let list of lists"
    (clickOutside)="clickOutside({$event, list})"
  >
    <p class="list-title">
      {{ list.title }}
    </p>
    <div class="flex-column w-full mt-7 cards-wrapper">
      <div
        class="flex-column w-full cards"
        (cdkDropListDropped)="drop($event)"
        [cdkDropListData]="list.cards"
        cdkDropList
      >
        <div class="card" cdkDrag *ngFor="let card of list.cards">
          <ng-container
            *ngTemplateOutlet="cardTemplate; context: { $implicit: card }"
          ></ng-container>
        </div>
      </div>

      <!-- Add card -->
      <div class="add-card-row mt-10 flex">
        <button
          *ngIf="!list.isCreatingCard"
          (click)="startCreatingCard({$event, list})"
          pButton
          class="p-button-sm p-button-text"
          icon="pi pi-plus"
          label="Add a card"
        ></button>

        <button
          *ngIf="list.isCreatingCard"
          (click)="createCard({$event, list})"
          pButton
          class="p-button-sm"
          label="Add"
        ></button>
      </div>
    </div>
  </div>

  <!-- Add list -->
  <div
    (click)="startCreatingList()"
    [class.editing]="isCreatingList"
    class="list add"
    (clickOutside)="isCreatingList = false"
  >
    <span class="pre-editing-text">+ Add another list</span>
    <form class="add-list-form" (submit)="addList($event)">
      <ng-container *ngIf="addListTemplate; else defaultAddListForm">
        <ng-container *ngTemplateOutlet="addListTemplate"></ng-container>
      </ng-container>
    </form>
  </div>
</div>

<ng-template #defaultAddListForm>
  <input
    #addListInput
    autofocus
    [formControl]="listTitleFormControl"
    pInputText
    placeholder="Enter list title"
    type="text"
  />
  <div class="space-between mt-6">
    <button
      pButton
      type="submit"
      class="p-button-text"
      icon="pi pi-plus"
    ></button>
    <button
      pButton
      type="button"
      class="p-button-text"
      icon="pi pi-times"
      (click)="stopEditing($event)"
    ></button>
  </div>
</ng-template>
